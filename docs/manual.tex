\documentclass[a4paper,10pt, oneside]{book}

\usepackage{titlesec}  % Allow the chapter/section heading settings to be fine-tuned.  Needs to come before bidi, in polyglossia.
\usepackage{polyglossia}  % multilingual support
\usepackage{xcolor}  % can't use color with polyglossia

\usepackage{tabularx}  % Needs to be above longtable
\usepackage{longtable}  % Tables that split over a pagebreak.
\usepackage{booktabs}  % Modern-style tables.
\usepackage{multirow}  % Merge cells in a table: provides \multirow, \multicolumn
\usepackage{array}  % Allows justification to be specified in tabularx columns.

\usepackage{footnote}  % Saves footnotes in a table and prints them out at the end, so that they show properly.  Use \begin|\end{savenotes}.

\usepackage{pdfpages}

\usepackage[obeyspaces]{url}  % Use urls in text and captions with sensible linewrap.
% \urlstyle{rm}  % Set urls in roman.

\usepackage{graphicx}  % Allows images to be inserted.

\usepackage{appendix}  % Provides additional appendixing capabilities.
% \usepackage{tocloft}
% \setlength{\cftsecnumwidth}{1cm}  % 
% \setlength{\cftsubsecnumwidth}{1.5cm}  % 

\usepackage[labelfont=bf,textfont=it]{caption} % Set properties for captions.

\usepackage{marginnote}  %provides more flexible margin notes
\renewcommand*{\marginfont}{\color{red}\sffamily}  % colour the margin notes red

\usepackage{natbib}

\usepackage{cleveref}

\usepackage{datetime}
% \renewcommand{\dateseparator}{-}
% \newcommand{\todayiso}{\the\year \dateseparator \twodigit\month \dateseparator \twodigit\day}
\renewcommand{\dateseparator}{ }
\newcommand{\todayuk}{\the\day \dateseparator \monthname \dateseparator \the\year}

% use the float package
% we can then use H to insist on placement of graphics HERE at an exact point
\usepackage{float}

\interfootnotelinepenalty=10000 % prevents the footnote from breaking across pages
% http://tex.stackexchange.com/questions/32208/footnote-runs-onto-second-page

% Thanks to Manas Tungare (http://manas.tungare.name/software/latex) for these settings.
\setlength{\paperwidth}{210mm}
\setlength{\paperheight}{297mm}

\setlength{\textwidth}{160mm}
\setlength{\textheight}{247mm}

\setlength{\evensidemargin}{1in}
\setlength{\oddsidemargin}{0in}
\setlength{\topmargin}{-0.5in}

%--------------------------------
%%% Font definitions %%%
%--------------------------------
% Note that these definitions malfunction if used in \chapter.
\defaultfontfeatures{Mapping=tex-text}
\setmainfont{Charis SIL}  % Set the default font for the document. = \setdefaultfont
% Footnotes will by default also use this font -- http://tex.stackexchange.com/questions/4779/how-to-change-font-family-in-footnote).
\defaultfontfeatures{Scale=MatchLowercase}  % needs to be below main font declaration

\setsansfont{Liberation Sans}
\setmonofont{Liberation Mono}
% \setmonofont{Lato}

\setmainlanguage{english}
\setotherlanguage{arabic}

\newfontfamily\arabicfont[Script=Arabic, Scale=2]{Scheherazade} % Arabic transcription -- coloured black, double size.
% One font needs to be called \arabicfont in order for XeTeX to load Arabic-related hyphenation and other stuff.
%  The default \textarabic will use this \arabicfont.  Use the \begin{Arabic} ..... \end{Arabic} environment for longer stretches (eg paras).
% Use \textarabic{\aemph{با}} to give overline emphasis.
% Omitting Script=Arabic for Amiri or Granada will mean that letters are written in their standalone forms, not connected.  (Omitting Script=Arabic for Scheherazade seems to cause no problem, though.)

\newfontfamily\citationfont[Script=Arabic, Scale=1.5]{Scheherazade}  % Citations, or stand-alone Arabic script in the middle of Roman script -- coloured black, one-and-a-half size.
\newcommand\AS[1]{{\citationfont\RLE{#1}}}
% \RLE (from the bidi package, which polyglossia loads automatically) is to allow multiple words of Arabic to be written right-to-left -- if omitted, each word in the sequence will be written RTL, but the sequence as a whole will be written LTR.

%You can either, as above, define a new \fontfamily, and then use it in a \newcommand, or you can, as below, include the font in the \newcommand by calling \fontspec directly.

\newcommand\Atitle[1]{{\fontspec[Script=Arabic, Scale=2]{GranadaKD}\RLE{#1}}}  % Arabic transcription for titles - uses a version of Granada which has been extended to include glyphs for Swahili.

\newcommand\Am[1]{{\fontspec[Script=Arabic]{Amiri}\RLE{#1}}} % Examples using Amiri --  if using Scheherazade's default scale, set Scale=0.8 here.

%\newfontfamily\translitfont[Scale=1, Color=666666]{Linux Biolinum O}
%\newcommand\Tr[1]{{\translitfont\RLE{#1}}}
\newcommand\Tr[1]{{\fontspec[Scale=1, Color=666666]{Linux Biolinum O}#1}}   %  Transliteration -- Biolinum handles diacritics well.  Coloured grey, slightly less than normal size.
% Scale=1 is required because of Scale=MatchLowercase - otherwise the size is too large.

\newcommand\In[1]{{\fontspec[Scale=1, Color=blue]{Linux Biolinum O}#1}}  % Epenthetic letters in the transliteration -- coloured blue, normal size.

\newcommand\Swa[1]{{\fontspec[Color=00BB33, Scale=1]{Linux Biolinum O}#1}}  % Standard spelling -- coloured green, normal size.

\newcommand\E[1]{{\fontspec[Scale=0.9, Color=333333]{Liberation Serif Italic}#1}}  % English translation layer -- coloured grey, slightly less than normal size.

\newcommand\Eit[1]{{\fontspec{Liberation Serif Italic}#1}}  % English italics.

\newcommand\FN[1]{{\fontspec[Color=00BB33]{Liberation Serif Italic}#1}} % Standout type in footnotes -- coloured green, normal size.

% Older versions:
% \newfontfamily{\Tr}[Scale=0.9, Color=00BB33]{Linux Biolinum O}
% This can be used as \Tr{text}.  But this will change the font outside the argument until the end of that stretch.
% This doesn't show up in the poemlines, because they are self-contained, but it does show up in connected text.
% To avoid this, and have the font only changed within the argument, use \newcommand as above.
% Though you can also enclose \Tr in braces to limit it: {\Tr{}}

%----------------------------------------
%%% End of font definitions %%%
%----------------------------------------

% titlesec commands have to come after 
% \setmainlanguage{english}
% \setotherlanguage{arabic}
% above, otherwise they are overridden and have no effect.
\titleformat{\chapter}[display]{\normalfont\large}{\bfseries\chaptertitlename\ \thechapter}{10pt}{\LARGE\itshape}[\vspace{2ex}\titlerule]  % 10pt is the space between chapter and chapter name.  [display] sets the chapter and chapter name on separate lines.  The square brackets at the end draw a line under each chapter name, with 2ex gap from the name.
\titlespacing{\chapter}{0pt}{0pt}{10pt}  % First is indent from the side, second is length down from the top, third is gap between heading and text.
\titleformat{\section}[block]{\normalfont\large\itshape}{\itshape\thesection}{1em}{}  % 1em is the space between section number and section name.  [block] sets the section and section name on the same line.
\titleformat{\subsection}[block]{\normalfont\normalsize\bfseries}{\bfseries\thesubsection}{1em}{}

\renewcommand\thefootnote{\textcolor{red}{\arabic{footnote}}}  % Alter the colour of the footnote markers - thanks to Gonzalo Medina (http://tex.stackexchange.com/questions/26693/change-the-color-of-footnote-marker-in-latex#26696).

\usepackage{underscore}  % Escape _ so that it doesn't cause compile errors.

\setlength{\parindent}{0in}  % no paragraph indents
\setlength{\parskip}{2ex}  % put a linespace between paragraphs

% Define superscripts in red, subscripts in blue, and the two stacked.
% http://tex.stackexchange.com/questions/8255/superscript-and-subscript-together
\def\SP#1{\textsuperscript{\textcolor{blue}{#1}}}
\def\SB#1{\textsubscript{\textcolor{blue}{#1}}}
\def\SPSB#1#2{\rlap{\textsuperscript{\textcolor{blue}{#1}}}\SB{#2}}

% Define a highlighter for consonant/vowel.
\def\CV#1{\textcolor{blue}{#1}}

\includeonly{chapter8poetry}

\begin{document}
\frenchspacing  % Two spaces between sentences.

\include{frontmatter}

\include{chapter1intro}

\include{chapter2examples}

\include{chapter3started}

\include{chapter4fonts}

\include{chapter5keyboard}

\include{chapter6spelling}

\include{chapter7conversion}

\include{chapter8poetry}


\newpage

\renewcommand{\bibname}{References}
\bibliographystyle{chicago}
\bibliography{andika.bib}
% 
% 
% \newpage
% \appendix  % Start the appendices.
% 
% \input{appendixAinstall}  % stackoverflow.com/questions/1209065/to-have-no-pagebreak-after-include-in-latex
% % \newpage
% 
% \input{appendixBfontforge}
% % \newpage
% 
% \input{appendixCkeyboard}
% % \newpage
% 
% \input{appendixD}
% % \newpage
% 
% % % To include the pdf directly:
% % % \includepdf[pages={ - }, pagecommand={}]{../convert/outputs/kiswahili/kiswahili.pdf}
% % % stackoverflow.com/questions/2739159/inserting-a-pdf-file-in-latex
% % % tex.stackexchange.com/questions/71427/include-several-pages-of-a-pdf-without-losing-latex-document-style#71435
% % % use pagenumbering{gobble} when generating the pdf, so that it does not have its own pagenumbering.
% 
% \input{appendixEtz}
% % \newpage


\end{document}